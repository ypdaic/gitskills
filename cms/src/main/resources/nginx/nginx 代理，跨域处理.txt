server {
        listen       8089;
        server_name  test;
        #charset koi8-r;

        #access_log  logs/host.access.log  main;

       # location / {
       #     root   html;
       #     index  index.html index.htm;
       # }
       location / {
            # 允许跨域域名的列表,要么配置*（全匹配),要么配置指定域名列表例如：http://localhost:8087,但nginx 不支持配置多个域名
            # 如这种形式 add_header Access-Control-Allow-Origin 'http://localhost:8087,http://localhost:8088';
            # 可以使用如下方式
            set $cors_origin "";
            if ($http_origin ~* "^http://localhost:8087$") {
                set $cors_origin $http_origin;
            }
            if ($http_origin ~* "^http://localhost:8088$") {
                set $cors_origin $http_origin;
            }
            add_header Access-Control-Allow-Origin $cors_origin;
#           add_header Access-Control-Allow-Origin '*';
            # 允许跨域请求头,一般使用*（全匹配）,也可指定, 要注意的是Origin请求头是无法设置的,由浏览器自动设置
            add_header Access-Control-Allow-Headers 'content-type';
            # 允许跨域的请求方法
            add_header Access-Control-Allow-Methods 'GET,POST,OPTIONS,PUT,DELETE,HEAD';
#            add_header Access-Control-Allow-Credentials true;
            # 当请求为PUT,DELETE复杂请求时，浏览器会发送一个OPTIONS的预检请求，后台需要对该请求响应，并设置响应码为204
            if ($request_method = 'OPTIONS') {
                return 204;
            }

            # 设置代理
            proxy_pass http://localhost:8086/springcloud-provider/;
        }
        #error_page  404              /404.html;

        # redirect server error pages to the static page /50x.html
        #
        error_page   500 502 503 504  /50x.html;
        location = /50x.html {
            root   html;
        }
}

